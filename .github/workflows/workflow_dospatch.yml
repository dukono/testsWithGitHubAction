name: Debug outputs

on: 
  workflow_dispatch:  # Ejecuci√≥n manual para testing
    inputs:
        environment:   # üëà Nombre del input (t√∫ lo defines)
          description: "Entorno de despliegue"
          required: true
          type: choice
          options:
            - production
            - staging
            - development
        
        debug-mode:
          description: "Habilitar modo debug"
          required: false
          default: false
          type: boolean
jobs:
  demo:
    runs-on: ubuntu-latest
    steps:
    - name: Debug inputs
      run: |
        echo "Contenido de input:"
        echo '${{ toJSON(github.event.inputs) }}'
        inputObject= ${{ toJSON(github.event.inputs) }}
        echo inputObject.environment
    - name: Paso 1 - Crear output
      id: get_version  # üëà ID CR√çTICO: nombre que usar√°s despu√©s
      run: |
        echo "=== DEBUG PASO 1 ==="
        
        # Mostrar d√≥nde est√° el archivo GITHUB_OUTPUT
        echo "Ruta de GITHUB_OUTPUT: $GITHUB_OUTPUT"
        
        # Mostrar contenido actual (vac√≠o al inicio)
        echo "Contenido inicial:"
        cat "$GITHUB_OUTPUT" || echo "(archivo vac√≠o)"
        
        # Escribir nuestro valor
        echo "Escribiendo: version=1.2.3"
        echo "version=1.2.3" >> "$GITHUB_OUTPUT"
        
        # Verificar que se escribi√≥
        echo "Contenido despu√©s de escribir:"
        cat "$GITHUB_OUTPUT"
      
    - name: Paso 2 - Leer output
      run: |
        echo "=== DEBUG PASO 2 ==="
        
        # ‚úÖ Forma CORRECTA: usar contexto steps
        echo "Versi√≥n desde steps.get_version.outputs.version: ${{ steps.get_version.outputs.version }}"
        
        # ‚ùå Forma INCORRECTA: no existe como variable de entorno
        echo "Versi√≥n desde $VERSION (no existe): $VERSION"
    
    - name: Paso 3 - Usar el valor en operaciones reales
      run: |
        VERSION="${{ steps.get_version.outputs.version }}"
        echo "Deployando versi√≥n $VERSION a producci√≥n..."
        # ./deploy.sh --version "$VERSION"
